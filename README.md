# Disabled_RGA2_OrangePi5Ultra
## Инструкция по отключению RGA2 в Orange pi 5 Ultra
#### Данная инструкция предназначена для решения проблемы с аппаратным ускорителем 2D-графики RGA.
#### В процессоре RK3588 имеется два типа аппаратных ускорителей 2D-графики. Это RGA2 и RGA3.
### **Отличия аппаратных ускорителей RGA2 и RGA3 в RK3588**  

#### **1. Разница в архитектуре и количестве ядер**  
- **RGA2** – одноядерный ускоритель, унаследованный от предыдущих чипов Rockchip (например, RK3399).  
  - **Одно ядро** → ограниченная параллельная обработка, ниже производительность.  
  - Оптимизирован для базовых операций: масштабирование, поворот, альфа-смешивание.  
- **RGA3** – двухъядерный, более современный блок.  
  - **Два ядра** → выше параллелизм, лучше справляется с сложными задачами (например, одновременная обработка нескольких потоков видео).  
  - Добавлены новые функции: бикубическое масштабирование, 10-битные форматы, улучшенная работа с HDR.  

#### **2. Ограничение памяти RGA2 (4 ГБ)**  
RGA2 не поддерживает адресацию памяти **свыше 4 ГБ** из-за:  
- **32-битной адресации** – старый дизайн, унаследованный от предыдущих поколений.  
- **Ограничения DMA (Direct Memory Access)** – RGA2 использует 32-битные регистры для работы с памятью, что не позволяет обращаться к адресам выше `0xFFFFFFFF` (4 ГБ).  
- **Совместимость** – RGA2 изначально проектировался для систем с небольшим объемом ОЗУ (например, в RK3398/RK3399 обычно стоит ≤4 ГБ).  

#### **3. RGA3 поддерживает >4 ГБ благодаря 64-битной адресации**  
- Использует **64-битные DMA-регистры**, что позволяет работать с большими буферами.  
- Оптимизирован для современных задач (например, обработка 4K/8K видео с высоким разрешением).  

### **Почему в RK3588 оставили RGA2, если есть RGA3?**  
1. **Совместимость** – старые приложения и драйверы могут задействовать RGA2.  
2. **Распределение нагрузки** – простые задачи (например, UI-рендеринг) можно отдать RGA2, а сложные (видео, CV) – RGA3.  
3. **Энергоэффективность** – для несложных операций RGA2 может потреблять меньше энергии.  

### **Вывод**  
- **RGA3** – более мощный (2 ядра, 64-битная адресация, новые форматы).  
- **RGA2** – оставлен для совместимости, но ограничен 4 ГБ ОЗУ и 32-битной адресацией.  
- Если ваш orange pi 5 ultra (или любой другой одноплатный ПК) имеет более 4 ГБ оперативной памяти, то необходимо отключить RGA2, так как если планировщик перенаправит задание обработки изображения с RGA3 на RGA2, то система зависнет.

### **Инструкция по отключению RGA2**
##### 1. Проверьте доступные блоки RGA
```
dmesg | grep rga
```
Пример вывода
